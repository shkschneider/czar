// arena.cz - Arena allocator for fast bump allocation
// Part of the Czar standard library
#module alloc

#import iAlloc

// Arena allocator struct that implements the alloc interface
struct Arena : iAlloc {
    u64 size
    any buffer
    u64 offset
}

// Constructor - allocates the arena buffer
fn Arena:init() void {
    #unsafe {
        cz_alloc_arena_init(self);
    }
}

// Destructor - frees the arena buffer
fn Arena:fini() void {
    #unsafe {
        cz_alloc_arena_fini(self);
    }
}

// Allocate memory from arena
fn Arena:alloc(u64 size) any {
    mut any result = null
    #unsafe {
        result = _alloc(self, size);
    }
    return result
}

// Reallocate memory within arena
fn Arena:ralloc(any ptr, u64 new_size) any {
    mut any result = null
    #unsafe {
        result = _ralloc(self, ptr, new_size);
    }
    return result
}

// Free memory (no-op for arena allocator)
// Arena allocators don't free individual allocations
fn Arena:free(any ptr) void {
    // No-op: arena allocator doesn't free individual allocations
    // Use clear() to reset the entire arena
}

// Clear arena (reset all allocations)
fn Arena:clear() void {
    #unsafe {
        _clear(self);
    }
}
