// Comprehensive test of 'any' type with various pointer operations
// Demonstrates casting between different types through 'any'

struct Point {
    i32 x
    i32 y
}

struct Box {
    i32 width
    i32 height
}

struct GenericContainer {
    any ptr1
    any ptr2
}

fn swap_pointers(mut GenericContainer container) -> void {
    // Swap the two any pointers
    any temp = container.ptr1
    container.ptr1 = container.ptr2
    container.ptr2 = temp
}

fn get_point_x(any ptr) -> i32 {
    Point p = cast<Point> ptr
    return p.x
}

fn get_box_width(any ptr) -> i32 {
    Box b = cast<Box> ptr
    return b.width
}

fn main() -> i32 {
    // Create different struct types
    Point p = Point { x: 5, y: 10 }
    Box b = Box { width: 20, height: 30 }
    
    // Store both in a container as 'any'
    GenericContainer container = GenericContainer {
        ptr1: cast<any> p,
        ptr2: cast<any> b
    }
    
    // Access through any
    i32 x1 = get_point_x(container.ptr1)
    i32 w1 = get_box_width(container.ptr2)
    
    // Swap them
    swap_pointers(mut container)
    
    // Access again after swap (types are now swapped)
    i32 w2 = get_box_width(container.ptr1)
    i32 x2 = get_point_x(container.ptr2)
    
    // Verify all values are correct
    if x1 == 5 {
        if w1 == 20 {
            if w2 == 20 {
                if x2 == 5 {
                    return 1  // success
                }
            }
        }
    }
    
    return 0  // failure
}
