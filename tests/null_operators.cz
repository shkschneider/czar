// Test null-safety operators: !!, ??, ?.

struct Node {
    i32 value
    Node* next
}

fn maybe_null_ptr(bool should_be_null) -> Node* {
    if should_be_null {
        return null
    } else {
        Node result = new Node { value: 10, next: null }
        return result
    }
}

fn main() -> i32 {
    // Test null coalescing operator ??
    Node* p1 = null
    i32 result1 = 0 ?? 5  // Should be 5

    // Test with heap-allocated node (using new without pointer type)
    Node p2 = new Node { value: 20, next: null }

    // Safe navigation test - node on heap
    Node p3 = new Node { value: 15, next: null }
    i32 safe_value = p3.value  // Should be 15

    // Safe navigation test - pointer is null
    Node* p4 = null
    i32 safe_null = p4?.value ?? 100  // Should be 100 (p4 is null)

    // Return combination of tests
    return result1 + safe_value + safe_null  // 5 + 15 + 100 = 120
}
