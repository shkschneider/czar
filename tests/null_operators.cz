// Test null-safety operators: !!, ??, ?.

struct Node {
    i32 value
    Node* next
}

fn maybe_null(bool should_be_null) -> Node* {
    if should_be_null {
        return null
    } else {
        var Node n = Node { value: 10, next: null }
        return &n
    }
}

fn main() -> i32 {
    // Test null coalescing operator ??
    var Node* p1 = null
    val i32 result1 = 0 ?? 5  // Should be 5
    
    // Test with pointer
    var Node n1 = Node { value: 20, next: null }
    var Node* p2 = &n1
    
    // Safe navigation test - pointer is not null
    var Node n2 = Node { value: 15, next: null }
    var Node* p3 = &n2
    val i32 safe_value = p3?.value ?? 0  // Should be 15
    
    // Safe navigation test - pointer is null
    var Node* p4 = null
    val i32 safe_null = p4?.value ?? 100  // Should be 100 (p4 is null)
    
    // Return combination of tests
    return result1 + safe_value + safe_null  // 5 + 15 + 100 = 120
}
