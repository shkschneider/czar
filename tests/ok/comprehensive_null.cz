// Comprehensive test of null handling
struct Data {
    i32 value
}

fn get_data() Data? {
    return new Data { value: 42 }
}

fn get_null() Data? {
    return null
}

fn main() i32 {
    // Test 1: null assignment
    Data? p1 = null
    if p1 == null {
        // Success
    } else {
        return 1
    }
    
    // Test 2: non-null assignment
    Data? p2 = new Data { value: 10 }
    if p2 != null {
        // Success - can access
        if p2.value == 10 {
            // Good
        } else {
            return 2
        }
    } else {
        return 3
    }
    
    // Test 3: function returning nullable
    Data? p3 = get_data()
    if p3 != null {
        if p3.value == 42 {
            // Good
        } else {
            return 4
        }
    } else {
        return 5
    }
    
    // Test 4: function returning null
    Data? p4 = get_null()
    if p4 == null {
        // Expected
    } else {
        return 6
    }
    
    return 0
}
