// Test interface with struct that has constructor and destructor

iface iCounter {
    fn increment() void
    fn get_value() i32
}

struct Counter : iCounter {
    i32 value
}

fn Counter:init() void {
    self.value = 0
}

fn Counter:fini() void {
    // Cleanup if needed
}

fn Counter:increment() void {
    self.value = self.value + 1
}

fn Counter:get_value() i32 {
    return self.value
}

fn main() i32 {
    Counter? c = new Counter {}
    #defer free c
    
    // Should start at 0 (initialized)
    if c:get_value() != 0 {
        return 1
    }
    
    // Increment and check
    c:increment()
    if c:get_value() != 1 {
        return 2
    }
    
    c:increment()
    c:increment()
    if c:get_value() != 3 {
        return 3
    }
    
    // Test that we can call methods multiple times
    c:increment()
    c:increment()
    if c:get_value() != 5 {
        return 4
    }
    
    return 0
}
