// Comprehensive pointer operations test
// Shows various ways to work with pointers

struct Data {
    i32 value
    i32 count
}

fn modify_data(mut Data? d) void {
    if (d != null) {
        d.value = d.value + 10
        d.count = d.count + 1
    }
}

fn main() i32 {
    // Create data on stack
    mut Data d1 = Data{value: 5, count: 0}

    // Get pointer to stack data (implicit)
    mut Data? ptr1 = d1

    // Modify through pointer
    modify_data(mut ptr1)

    // Heap allocation
    mut Data? ptr2 = new Data{value: 100, count: 5}

    // Modify heap data
    modify_data(mut ptr2)

    // Pointer assignment (copy pointer, not data)
    mut Data? ptr3 = ptr2
    ptr3.value = 999

    // Null pointer is safe to pass (function checks)
    Data? null_ptr = null
    modify_data(mut null_ptr)

    // Clean up heap memory
    free(ptr2)

    return 0
}
