// Test new String syntax: String { "text" } and String {}
#import cz.fmt

fn main() i32 {
    // Test heap-allocated String with new syntax
    String? s1 = new String { "Hello, World!" }

    // Test stack-allocated String with new syntax
    String s2 = String { "Stack String" }
    
    // Test empty string
    String s3 = String {}

    // Access String fields
    i32 len1 = s1.length
    i32 cap1 = s1.capacity
    i32 len2 = s2.length
    i32 cap2 = s2.capacity
    i32 len3 = s3.length

    // Get C-style string
    println(s1.cstr())
    println(s2.cstr())

    // Verify lengths
    if len1 != 13 {
        return 1
    }
    if len2 != 12 {
        return 2
    }
    if len3 != 0 {
        return 3
    }

    // Verify capacities are reasonable
    if cap1 < len1 {
        return 4
    }
    if cap2 < len2 {
        return 5
    }

    free s1
    return 0
}
